name: UI Tests
on: [push, pull_request]

permissions:
  contents: write

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-java@v3
        with: {distribution: temurin, java-version: 21}

      - run: mvn -B clean test -Dheadless=true

      - name: Generate index.html
        run: |
          cat <<'EOF' > reports/index.html
          <html><head><title>Test Reports</title></head><body>
          <h2>Automation Test Reports</h2>
          <ul>
            <li><a href="AddEmployeeTest_Report.html">AddEmployeeTest</a></li>
            <li><a href="LoginTest_Report.html">LoginTest</a></li>
            <li><a href="VerifyEmployeeTest_Report.html">VerifyEmployeeTest</a></li>
          </ul>
          </body></html>
          EOF

      - uses: peaceiris/actions-gh-pages@v3
        if: github.ref == 'refs/heads/main'
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./reports          # thư mục đã có index.html
          publish_branch: gh-pages